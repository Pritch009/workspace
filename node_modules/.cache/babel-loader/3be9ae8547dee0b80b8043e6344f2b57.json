{"ast":null,"code":"import { useLayoutEffect, useEffect } from 'react';\nfunction dispatchEvent(type, detail) {\n  window.dispatchEvent(new CustomEvent(type, {\n    detail\n  }));\n}\nconst useIsomorphicEffect = typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\nfunction createUseExternalEvents(prefix) {\n  function _useExternalEvents(events) {\n    const handlers = Object.keys(events).reduce((acc, eventKey) => {\n      acc[`${prefix}:${eventKey}`] = event => events[eventKey](event.detail);\n      return acc;\n    }, {});\n    useIsomorphicEffect(() => {\n      Object.keys(handlers).forEach(eventKey => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n        window.addEventListener(eventKey, handlers[eventKey]);\n      });\n      return () => Object.keys(handlers).forEach(eventKey => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n      });\n    }, [handlers]);\n  }\n  function createEvent(event) {\n    return function () {\n      return dispatchEvent(`${prefix}:${String(event)}`, arguments.length <= 0 ? undefined : arguments[0]);\n    };\n  }\n  return [_useExternalEvents, createEvent];\n}\nexport { createUseExternalEvents };","map":{"version":3,"sources":["../../src/create-use-external-events/create-use-external-events.ts"],"names":[],"mappings":";AACA,SAAS,aAAa,CAAC,IAAI,EAAE,MAAM,EAAE;EACnC,MAAM,CAAC,aAAa,CAAC,IAAI,WAAW,CAAC,IAAI,EAAE;IAAE;EAAM,CAAE,CAAC,CAAC;AACzD;AACA,MAAM,mBAAmB,GAAG,OAAO,MAAM,KAAK,WAAW,GAAG,eAAe,GAAG,SAAS;AAChF,SAAS,uBAAuB,CAAC,MAAM,EAAE;EAC9C,SAAS,kBAAkB,CAAC,MAAM,EAAE;IAClC,MAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,QAAQ,KAAK;MAC7D,GAAG,CAAE,GAAE,MAAO,IAAG,QAAS,EAAC,CAAC,GAAI,KAAK,IAAK,MAAM,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;MACxE,OAAO,GAAG;IAChB,CAAK,EAAE,CAAA,CAAE,CAAC;IACN,mBAAmB,CAAC,MAAM;MACxB,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAE,QAAQ,IAAK;QAC1C,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACxD,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;MAC7D,CAAO,CAAC;MACF,OAAO,MAAM,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAE,QAAQ,IAAK;QACvD,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;MAChE,CAAO,CAAC;IACR,CAAK,EAAE,CAAC,QAAQ,CAAC,CAAC;EAClB;EACE,SAAS,WAAW,CAAC,KAAK,EAAE;IAC1B,OAAO;MAAA,OAAgB,aAAa,CAAE,GAAE,MAAO,IAAG,MAAM,CAAC,KAAK,CAAE,EAAC,EAAA,SAAA,CAAA,MAAA,QAAA,SAAA,GAAA,SAAA,GAAY,CAAC;IAAA;EAClF;EACE,OAAO,CAAC,kBAAkB,EAAE,WAAW,CAAC;AAC1C","sourcesContent":["import { useEffect, useLayoutEffect } from 'react';\n\nfunction dispatchEvent<T>(type: string, detail?: T) {\n  window.dispatchEvent(new CustomEvent(type, { detail }));\n}\n\nconst useIsomorphicEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\nexport function createUseExternalEvents<Handlers extends Record<string, (detail: any) => void>>(\n  prefix: string\n) {\n  function _useExternalEvents(events: Handlers) {\n    const handlers = Object.keys(events).reduce((acc, eventKey) => {\n      acc[`${prefix}:${eventKey}`] = (event: CustomEvent) => events[eventKey](event.detail);\n      return acc;\n    }, {});\n\n    useIsomorphicEffect(() => {\n      Object.keys(handlers).forEach((eventKey) => {\n        window.removeEventListener(eventKey, handlers[eventKey]);\n        window.addEventListener(eventKey, handlers[eventKey]);\n      });\n\n      return () =>\n        Object.keys(handlers).forEach((eventKey) => {\n          window.removeEventListener(eventKey, handlers[eventKey]);\n        });\n    }, [handlers]);\n  }\n\n  function createEvent<EventKey extends keyof Handlers>(event: EventKey) {\n    type Parameter = Parameters<Handlers[EventKey]>[0];\n\n    return (...payload: Parameter extends undefined ? [undefined?] : [Parameter]) =>\n      dispatchEvent(`${prefix}:${String(event)}`, payload[0]);\n  }\n\n  return [_useExternalEvents, createEvent] as const;\n}\n"]},"metadata":{},"sourceType":"module"}