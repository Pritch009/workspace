{"ast":null,"code":"var _jsxFileName = \"/Users/will/WebstormProjects/workspace/src/components/searchBar.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useRef } from \"react\";\nimport { BsSearchHeart } from \"react-icons/bs\";\nimport { Box, Input, rem, Title, Text, Alert, Portal } from \"@mantine/core\";\nimport { useBreeds } from \"../APIs/cats\";\nimport Fuse from \"fuse.js\";\nimport { useClickOutside } from \"@mantine/hooks\";\nimport { useLocation } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst fuseOptions = {\n  includeScore: true,\n  keys: [\"name\", \"origin\", \"description\"]\n};\nexport function SearchBar(_ref) {\n  _s();\n  let {\n    searchResultsContainerRef\n  } = _ref;\n  const {\n    data: breeds,\n    loading: loadingBreeds,\n    error\n  } = useBreeds();\n  const [err, setErr] = useState(null);\n  const [searchValue, setSearchValue] = useState(\"\");\n  const [suggestions, setSuggestions] = useState([]);\n  const location = useLocation();\n  const onChange = event => {\n    const newValue = event.currentTarget.value;\n    setSearchValue(newValue);\n    history.replaceState({\n      searchText: newValue\n    }, \"\", location.href);\n  };\n  useEffect(() => {\n    if (breeds && breeds.length > 0) {\n      if (searchValue.length > 0) {\n        const fuse = new Fuse(breeds, fuseOptions);\n        let results = fuse.search(searchValue);\n        setSuggestions(results.filter(_ref2 => {\n          let {\n            score\n          } = _ref2;\n          return score < 0.3;\n        }));\n      } else {\n        let randomOrder = breeds.sort((_ref3, _ref4) => {\n          let {\n            name: a\n          } = _ref3;\n          let {\n            name: b\n          } = _ref4;\n          return a.localeCompare(b);\n        }).map(item => ({\n          item\n        }));\n        setSuggestions(randomOrder);\n      }\n    }\n  }, [breeds, searchValue]);\n  useEffect(() => {\n    var _location$state;\n    const {\n      searchText\n    } = (_location$state = location.state) !== null && _location$state !== void 0 ? _location$state : {};\n    setSearchValue(searchText !== null && searchText !== void 0 ? searchText : \"\");\n  }, [location]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      position: \"relative\",\n      width: \"100%\"\n    },\n    children: [error && /*#__PURE__*/_jsxDEV(Alert, {\n      title: \"Error!\",\n      children: error.response.statusText\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 17\n    }, this), err && /*#__PURE__*/_jsxDEV(Alert, {\n      title: \"Error!\",\n      children: JSON.stringify(err)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 15\n    }, this), loadingBreeds && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 25\n    }, this), !loadingBreeds && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        icon: /*#__PURE__*/_jsxDEV(BsSearchHeart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 19\n        }, this),\n        value: searchValue,\n        onChange: onChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Portal, {\n        target: searchResultsContainerRef.current,\n        children: suggestions.map((_ref5, index) => {\n          let {\n            item: suggestion\n          } = _ref5;\n          return /*#__PURE__*/_jsxDEV(SearchOption, {\n            index: index,\n            breed: suggestion\n          }, suggestion.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n}\n_s(SearchBar, \"sNTZO4R2ggATHsVief9zWOo29pk=\", false, function () {\n  return [useBreeds, useLocation];\n});\n_c = SearchBar;\nfunction SearchOption(_ref6) {\n  let {\n    breed,\n    index,\n    ...props\n  } = _ref6;\n  return /*#__PURE__*/_jsxDEV(Box, {\n    component: \"a\",\n    ...props,\n    href: `/breed/${breed.id}`,\n    tabIndex: 0,\n    sx: {\n      display: \"flex\",\n      padding: rem(8)\n    },\n    children: breed.name\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n}\n_c2 = SearchOption;\nvar _c, _c2;\n$RefreshReg$(_c, \"SearchBar\");\n$RefreshReg$(_c2, \"SearchOption\");","map":{"version":3,"names":["useEffect","useState","useRef","BsSearchHeart","Box","Input","rem","Title","Text","Alert","Portal","useBreeds","Fuse","useClickOutside","useLocation","jsxDEV","_jsxDEV","Fragment","_Fragment","fuseOptions","includeScore","keys","SearchBar","_ref","_s","searchResultsContainerRef","data","breeds","loading","loadingBreeds","error","err","setErr","searchValue","setSearchValue","suggestions","setSuggestions","location","onChange","event","newValue","currentTarget","value","history","replaceState","searchText","href","length","fuse","results","search","filter","_ref2","score","randomOrder","sort","_ref3","_ref4","name","a","b","localeCompare","map","item","_location$state","state","sx","position","width","children","title","response","statusText","fileName","_jsxFileName","lineNumber","columnNumber","JSON","stringify","icon","target","current","_ref5","index","suggestion","SearchOption","breed","id","_c","_ref6","props","component","tabIndex","display","padding","_c2","$RefreshReg$"],"sources":["/Users/will/WebstormProjects/workspace/src/components/searchBar.js"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\nimport { BsSearchHeart } from \"react-icons/bs\";\nimport { Box, Input, rem, Title, Text, Alert, Portal } from \"@mantine/core\";\nimport { useBreeds } from \"../APIs/cats\";\nimport Fuse from \"fuse.js\";\nimport { useClickOutside } from \"@mantine/hooks\";\nimport { useLocation } from \"react-router-dom\";\n\nconst fuseOptions = {\n  includeScore: true,\n  keys: [\"name\", \"origin\", \"description\"],\n};\n\nexport function SearchBar({ searchResultsContainerRef }) {\n  const { data: breeds, loading: loadingBreeds, error } = useBreeds();\n  const [err, setErr] = useState(null);\n  const [searchValue, setSearchValue] = useState(\"\");\n  const [suggestions, setSuggestions] = useState([]);\n  const location = useLocation();\n\n  const onChange = (event) => {\n    const newValue = event.currentTarget.value;\n    setSearchValue(newValue);\n    history.replaceState({ searchText: newValue }, \"\", location.href);\n  };\n\n  useEffect(() => {\n    if (breeds && breeds.length > 0) {\n      if (searchValue.length > 0) {\n        const fuse = new Fuse(breeds, fuseOptions);\n        let results = fuse.search(searchValue);\n        setSuggestions(results.filter(({ score }) => score < 0.3));\n      } else {\n        let randomOrder = breeds\n          .sort(({ name: a }, { name: b }) => a.localeCompare(b))\n          .map((item) => ({ item }));\n        setSuggestions(randomOrder);\n      }\n    }\n  }, [breeds, searchValue]);\n\n  useEffect(() => {\n    const { searchText } = location.state ?? {};\n    setSearchValue(searchText ?? \"\");\n  }, [location]);\n\n  return (\n    <Box\n      sx={{\n        position: \"relative\",\n        width: \"100%\",\n      }}\n    >\n      {error && <Alert title=\"Error!\">{error.response.statusText}</Alert>}\n      {err && <Alert title=\"Error!\">{JSON.stringify(err)}</Alert>}\n      {loadingBreeds && <div>Loading</div>}\n      {!loadingBreeds && (\n        <>\n          <Input\n            icon={<BsSearchHeart />}\n            value={searchValue}\n            onChange={onChange}\n          />\n\n          <Portal target={searchResultsContainerRef.current}>\n            {suggestions.map(({ item: suggestion }, index) => (\n              <SearchOption\n                key={suggestion.id}\n                index={index}\n                breed={suggestion}\n              />\n            ))}\n          </Portal>\n        </>\n      )}\n    </Box>\n  );\n}\n\nfunction SearchOption({ breed, index, ...props }) {\n  return (\n    <Box\n      component=\"a\"\n      {...props}\n      href={`/breed/${breed.id}`}\n      tabIndex={0}\n      sx={{\n        display: \"flex\",\n        padding: rem(8),\n      }}\n    >\n      {breed.name}\n    </Box>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}