{"ast":null,"code":"import React, { forwardRef, useRef, useState } from 'react';\nimport { useId, useUncontrolled, useScrollIntoView, useDidUpdate, useMergedRef } from '@mantine/hooks';\nimport { getDefaultZIndex, useComponentDefaultProps } from '@mantine/styles';\nimport { groupOptions } from '@mantine/utils';\nimport { DefaultValue } from './DefaultValue/DefaultValue.js';\nimport { DefaultItem } from '../Select/DefaultItem/DefaultItem.js';\nimport { filterData } from './filter-data/filter-data.js';\nimport { getSelectRightSectionProps } from '../Select/SelectRightSection/get-select-right-section-props.js';\nimport { SelectScrollArea } from '../Select/SelectScrollArea/SelectScrollArea.js';\nimport { SelectPopover } from '../Select/SelectPopover/SelectPopover.js';\nimport { SelectItems } from '../Select/SelectItems/SelectItems.js';\nimport useStyles from './MultiSelect.styles.js';\nimport { extractSystemStyles } from '../Box/style-system-props/extract-system-styles/extract-system-styles.js';\nimport { Input } from '../Input/Input.js';\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value\n}) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {})) if (__hasOwnProp.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols) for (var prop of __getOwnPropSymbols(b)) {\n    if (__propIsEnum.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source) if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0) target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols) for (var prop of __getOwnPropSymbols(source)) {\n    if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop)) target[prop] = source[prop];\n  }\n  return target;\n};\nfunction defaultFilter(value, selected, item) {\n  if (selected) {\n    return false;\n  }\n  return item.label.toLowerCase().trim().includes(value.toLowerCase().trim());\n}\nfunction defaultShouldCreate(query, data) {\n  return !!query && !data.some(item => item.value.toLowerCase() === query.toLowerCase());\n}\nfunction filterValue(value, data) {\n  if (!Array.isArray(value)) {\n    return void 0;\n  }\n  if (data.length === 0) {\n    return [];\n  }\n  const flatData = data.map(item => {\n    if (typeof item === \"object\") {\n      return item.value;\n    }\n    return item;\n  });\n  return value.filter(val => flatData.includes(val));\n}\nconst defaultProps = {\n  size: \"sm\",\n  valueComponent: DefaultValue,\n  itemComponent: DefaultItem,\n  transitionProps: {\n    transition: \"fade\",\n    duration: 0\n  },\n  maxDropdownHeight: 220,\n  shadow: \"sm\",\n  searchable: false,\n  filter: defaultFilter,\n  limit: Infinity,\n  clearSearchOnChange: true,\n  clearable: false,\n  clearSearchOnBlur: false,\n  disabled: false,\n  initiallyOpened: false,\n  creatable: false,\n  shouldCreate: defaultShouldCreate,\n  switchDirectionOnFlip: false,\n  zIndex: getDefaultZIndex(\"popover\"),\n  selectOnBlur: false,\n  positionDependencies: [],\n  dropdownPosition: \"flip\"\n};\nconst MultiSelect = forwardRef((props, ref) => {\n  const _a = useComponentDefaultProps(\"MultiSelect\", defaultProps, props),\n    {\n      className,\n      style,\n      required,\n      label,\n      description,\n      size,\n      error,\n      classNames,\n      styles,\n      wrapperProps,\n      value,\n      defaultValue,\n      data,\n      onChange,\n      valueComponent: Value,\n      itemComponent,\n      id,\n      transitionProps,\n      maxDropdownHeight,\n      shadow,\n      nothingFound,\n      onFocus,\n      onBlur,\n      searchable,\n      placeholder,\n      filter,\n      limit,\n      clearSearchOnChange,\n      clearable,\n      clearSearchOnBlur,\n      variant,\n      onSearchChange,\n      searchValue,\n      disabled,\n      initiallyOpened,\n      radius,\n      icon,\n      rightSection,\n      rightSectionWidth,\n      creatable,\n      getCreateLabel,\n      shouldCreate,\n      onCreate,\n      sx,\n      dropdownComponent,\n      onDropdownClose,\n      onDropdownOpen,\n      maxSelectedValues,\n      withinPortal,\n      switchDirectionOnFlip,\n      zIndex,\n      selectOnBlur,\n      name,\n      dropdownPosition,\n      errorProps,\n      labelProps,\n      descriptionProps,\n      form,\n      positionDependencies,\n      onKeyDown,\n      unstyled,\n      inputContainer,\n      inputWrapperOrder,\n      readOnly,\n      withAsterisk,\n      clearButtonProps,\n      hoverOnSearchChange,\n      disableSelectedItemFiltering\n    } = _a,\n    others = __objRest(_a, [\"className\", \"style\", \"required\", \"label\", \"description\", \"size\", \"error\", \"classNames\", \"styles\", \"wrapperProps\", \"value\", \"defaultValue\", \"data\", \"onChange\", \"valueComponent\", \"itemComponent\", \"id\", \"transitionProps\", \"maxDropdownHeight\", \"shadow\", \"nothingFound\", \"onFocus\", \"onBlur\", \"searchable\", \"placeholder\", \"filter\", \"limit\", \"clearSearchOnChange\", \"clearable\", \"clearSearchOnBlur\", \"variant\", \"onSearchChange\", \"searchValue\", \"disabled\", \"initiallyOpened\", \"radius\", \"icon\", \"rightSection\", \"rightSectionWidth\", \"creatable\", \"getCreateLabel\", \"shouldCreate\", \"onCreate\", \"sx\", \"dropdownComponent\", \"onDropdownClose\", \"onDropdownOpen\", \"maxSelectedValues\", \"withinPortal\", \"switchDirectionOnFlip\", \"zIndex\", \"selectOnBlur\", \"name\", \"dropdownPosition\", \"errorProps\", \"labelProps\", \"descriptionProps\", \"form\", \"positionDependencies\", \"onKeyDown\", \"unstyled\", \"inputContainer\", \"inputWrapperOrder\", \"readOnly\", \"withAsterisk\", \"clearButtonProps\", \"hoverOnSearchChange\", \"disableSelectedItemFiltering\"]);\n  const {\n    classes,\n    cx,\n    theme\n  } = useStyles({\n    invalid: !!error\n  }, {\n    name: \"MultiSelect\",\n    classNames,\n    styles,\n    unstyled,\n    size,\n    variant\n  });\n  const {\n    systemStyles,\n    rest\n  } = extractSystemStyles(others);\n  const inputRef = useRef();\n  const itemsRefs = useRef({});\n  const uuid = useId(id);\n  const [dropdownOpened, setDropdownOpened] = useState(initiallyOpened);\n  const [_hovered, setHovered] = useState(-1);\n  const [direction, setDirection] = useState(\"column\");\n  const [_searchValue, handleSearchChange] = useUncontrolled({\n    value: searchValue,\n    defaultValue: \"\",\n    finalValue: void 0,\n    onChange: onSearchChange\n  });\n  const [IMEOpen, setIMEOpen] = useState(false);\n  const {\n    scrollIntoView,\n    targetRef,\n    scrollableRef\n  } = useScrollIntoView({\n    duration: 0,\n    offset: 5,\n    cancelable: false,\n    isList: true\n  });\n  const isCreatable = creatable && typeof getCreateLabel === \"function\";\n  let createLabel = null;\n  const formattedData = data.map(item => typeof item === \"string\" ? {\n    label: item,\n    value: item\n  } : item);\n  const sortedData = groupOptions({\n    data: formattedData\n  });\n  const [_value, setValue] = useUncontrolled({\n    value: filterValue(value, data),\n    defaultValue: filterValue(defaultValue, data),\n    finalValue: [],\n    onChange\n  });\n  const valuesOverflow = useRef(!!maxSelectedValues && maxSelectedValues < _value.length);\n  const handleValueRemove = _val => {\n    if (!readOnly) {\n      const newValue = _value.filter(val => val !== _val);\n      setValue(newValue);\n      if (!!maxSelectedValues && newValue.length < maxSelectedValues) {\n        valuesOverflow.current = false;\n      }\n    }\n  };\n  const handleInputChange = event => {\n    handleSearchChange(event.currentTarget.value);\n    !disabled && !valuesOverflow.current && searchable && setDropdownOpened(true);\n  };\n  const handleInputFocus = event => {\n    typeof onFocus === \"function\" && onFocus(event);\n    !disabled && !valuesOverflow.current && searchable && setDropdownOpened(true);\n  };\n  const filteredData = filterData({\n    data: sortedData,\n    searchable,\n    searchValue: _searchValue,\n    limit,\n    filter,\n    value: _value,\n    disableSelectedItemFiltering\n  });\n  if (isCreatable && shouldCreate(_searchValue, sortedData)) {\n    createLabel = getCreateLabel(_searchValue);\n    filteredData.push({\n      label: _searchValue,\n      value: _searchValue,\n      creatable: true\n    });\n  }\n  const hovered = Math.min(_hovered, filteredData.length - 1);\n  const getNextIndex = (index, nextItem, compareFn) => {\n    let i = index;\n    while (compareFn(i)) {\n      i = nextItem(i);\n      if (!filteredData[i].disabled) return i;\n    }\n    return index;\n  };\n  useDidUpdate(() => {\n    if (hoverOnSearchChange && _searchValue) {\n      setHovered(0);\n    } else {\n      setHovered(-1);\n    }\n  }, [_searchValue, hoverOnSearchChange]);\n  useDidUpdate(() => {\n    if (!disabled && _value.length > data.length) {\n      setDropdownOpened(false);\n    }\n    if (!!maxSelectedValues && _value.length < maxSelectedValues) {\n      valuesOverflow.current = false;\n    }\n    if (!!maxSelectedValues && _value.length >= maxSelectedValues) {\n      valuesOverflow.current = true;\n      setDropdownOpened(false);\n    }\n  }, [_value]);\n  const handleItemSelect = item => {\n    if (!readOnly) {\n      clearSearchOnChange && handleSearchChange(\"\");\n      if (_value.includes(item.value)) {\n        handleValueRemove(item.value);\n      } else {\n        if (item.creatable && typeof onCreate === \"function\") {\n          const createdItem = onCreate(item.value);\n          if (typeof createdItem !== \"undefined\" && createdItem !== null) {\n            if (typeof createdItem === \"string\") {\n              setValue([..._value, createdItem]);\n            } else {\n              setValue([..._value, createdItem.value]);\n            }\n          }\n        } else {\n          setValue([..._value, item.value]);\n        }\n        if (_value.length === maxSelectedValues - 1) {\n          valuesOverflow.current = true;\n          setDropdownOpened(false);\n        }\n        if (filteredData.length === 1) {\n          setDropdownOpened(false);\n        }\n      }\n    }\n  };\n  const handleInputBlur = event => {\n    typeof onBlur === \"function\" && onBlur(event);\n    if (selectOnBlur && filteredData[hovered] && dropdownOpened) {\n      handleItemSelect(filteredData[hovered]);\n    }\n    clearSearchOnBlur && handleSearchChange(\"\");\n    setDropdownOpened(false);\n  };\n  const handleInputKeydown = event => {\n    if (IMEOpen) {\n      return;\n    }\n    onKeyDown == null ? void 0 : onKeyDown(event);\n    if (readOnly) {\n      return;\n    }\n    if (event.key !== \"Backspace\" && !!maxSelectedValues && valuesOverflow.current) {\n      return;\n    }\n    const isColumn = direction === \"column\";\n    const handleNext = () => {\n      setHovered(current => {\n        var _a2;\n        const nextIndex = getNextIndex(current, index => index + 1, index => index < filteredData.length - 1);\n        if (dropdownOpened) {\n          targetRef.current = itemsRefs.current[(_a2 = filteredData[nextIndex]) == null ? void 0 : _a2.value];\n          scrollIntoView({\n            alignment: isColumn ? \"end\" : \"start\"\n          });\n        }\n        return nextIndex;\n      });\n    };\n    const handlePrevious = () => {\n      setHovered(current => {\n        var _a2;\n        const nextIndex = getNextIndex(current, index => index - 1, index => index > 0);\n        if (dropdownOpened) {\n          targetRef.current = itemsRefs.current[(_a2 = filteredData[nextIndex]) == null ? void 0 : _a2.value];\n          scrollIntoView({\n            alignment: isColumn ? \"start\" : \"end\"\n          });\n        }\n        return nextIndex;\n      });\n    };\n    switch (event.key) {\n      case \"ArrowUp\":\n        {\n          event.preventDefault();\n          setDropdownOpened(true);\n          isColumn ? handlePrevious() : handleNext();\n          break;\n        }\n      case \"ArrowDown\":\n        {\n          event.preventDefault();\n          setDropdownOpened(true);\n          isColumn ? handleNext() : handlePrevious();\n          break;\n        }\n      case \"Enter\":\n        {\n          event.preventDefault();\n          if (filteredData[hovered] && dropdownOpened) {\n            handleItemSelect(filteredData[hovered]);\n          } else {\n            setDropdownOpened(true);\n          }\n          break;\n        }\n      case \" \":\n        {\n          if (!searchable) {\n            event.preventDefault();\n            if (filteredData[hovered] && dropdownOpened) {\n              handleItemSelect(filteredData[hovered]);\n            } else {\n              setDropdownOpened(true);\n            }\n          }\n          break;\n        }\n      case \"Backspace\":\n        {\n          if (_value.length > 0 && _searchValue.length === 0) {\n            setValue(_value.slice(0, -1));\n            setDropdownOpened(true);\n            if (maxSelectedValues) {\n              valuesOverflow.current = false;\n            }\n          }\n          break;\n        }\n      case \"Home\":\n        {\n          if (!searchable) {\n            event.preventDefault();\n            if (!dropdownOpened) {\n              setDropdownOpened(true);\n            }\n            const firstItemIndex = filteredData.findIndex(item => !item.disabled);\n            setHovered(firstItemIndex);\n            scrollIntoView({\n              alignment: isColumn ? \"end\" : \"start\"\n            });\n          }\n          break;\n        }\n      case \"End\":\n        {\n          if (!searchable) {\n            event.preventDefault();\n            if (!dropdownOpened) {\n              setDropdownOpened(true);\n            }\n            const lastItemIndex = filteredData.map(item => !!item.disabled).lastIndexOf(false);\n            setHovered(lastItemIndex);\n            scrollIntoView({\n              alignment: isColumn ? \"end\" : \"start\"\n            });\n          }\n          break;\n        }\n      case \"Escape\":\n        {\n          setDropdownOpened(false);\n        }\n    }\n  };\n  const selectedItems = _value.map(val => {\n    let selectedItem = sortedData.find(item => item.value === val && !item.disabled);\n    if (!selectedItem && isCreatable) {\n      selectedItem = {\n        value: val,\n        label: val\n      };\n    }\n    return selectedItem;\n  }).filter(val => !!val).map((item, index) => /* @__PURE__ */React.createElement(Value, __spreadProps(__spreadValues({}, item), {\n    variant,\n    disabled,\n    className: classes.value,\n    readOnly,\n    onRemove: event => {\n      event.preventDefault();\n      event.stopPropagation();\n      handleValueRemove(item.value);\n    },\n    key: item.value,\n    size,\n    styles,\n    classNames,\n    radius,\n    index\n  })));\n  const isItemSelected = itemValue => _value.includes(itemValue);\n  const handleClear = () => {\n    var _a2;\n    handleSearchChange(\"\");\n    setValue([]);\n    (_a2 = inputRef.current) == null ? void 0 : _a2.focus();\n    if (maxSelectedValues) {\n      valuesOverflow.current = false;\n    }\n  };\n  const shouldRenderDropdown = !readOnly && (filteredData.length > 0 ? dropdownOpened : dropdownOpened && !!nothingFound);\n  useDidUpdate(() => {\n    const handler = shouldRenderDropdown ? onDropdownOpen : onDropdownClose;\n    typeof handler === \"function\" && handler();\n  }, [shouldRenderDropdown]);\n  return /* @__PURE__ */React.createElement(Input.Wrapper, __spreadValues(__spreadValues({\n    required,\n    id: uuid,\n    label,\n    error,\n    description,\n    size,\n    className,\n    style,\n    classNames,\n    styles,\n    __staticSelector: \"MultiSelect\",\n    sx,\n    errorProps,\n    descriptionProps,\n    labelProps,\n    inputContainer,\n    inputWrapperOrder,\n    unstyled,\n    withAsterisk,\n    variant\n  }, systemStyles), wrapperProps), /* @__PURE__ */React.createElement(SelectPopover, {\n    opened: shouldRenderDropdown,\n    transitionProps,\n    shadow: \"sm\",\n    withinPortal,\n    __staticSelector: \"MultiSelect\",\n    onDirectionChange: setDirection,\n    switchDirectionOnFlip,\n    zIndex,\n    dropdownPosition,\n    positionDependencies: [...positionDependencies, _searchValue],\n    classNames,\n    styles,\n    unstyled,\n    variant\n  }, /* @__PURE__ */React.createElement(SelectPopover.Target, null, /* @__PURE__ */React.createElement(\"div\", {\n    className: classes.wrapper,\n    role: \"combobox\",\n    \"aria-haspopup\": \"listbox\",\n    \"aria-owns\": dropdownOpened && shouldRenderDropdown ? `${uuid}-items` : null,\n    \"aria-controls\": uuid,\n    \"aria-expanded\": dropdownOpened,\n    onMouseLeave: () => setHovered(-1),\n    tabIndex: -1\n  }, /* @__PURE__ */React.createElement(\"input\", {\n    type: \"hidden\",\n    name,\n    value: _value.join(\",\"),\n    form,\n    disabled\n  }), /* @__PURE__ */React.createElement(Input, __spreadValues({\n    __staticSelector: \"MultiSelect\",\n    style: {\n      overflow: \"hidden\"\n    },\n    component: \"div\",\n    multiline: true,\n    size,\n    variant,\n    disabled,\n    error,\n    required,\n    radius,\n    icon,\n    unstyled,\n    onMouseDown: event => {\n      var _a2;\n      event.preventDefault();\n      !disabled && !valuesOverflow.current && setDropdownOpened(!dropdownOpened);\n      (_a2 = inputRef.current) == null ? void 0 : _a2.focus();\n    },\n    classNames: __spreadProps(__spreadValues({}, classNames), {\n      input: cx({\n        [classes.input]: !searchable\n      }, classNames == null ? void 0 : classNames.input)\n    })\n  }, getSelectRightSectionProps({\n    theme,\n    rightSection,\n    rightSectionWidth,\n    styles,\n    size,\n    shouldClear: clearable && _value.length > 0,\n    onClear: handleClear,\n    error,\n    disabled,\n    clearButtonProps,\n    readOnly\n  })), /* @__PURE__ */React.createElement(\"div\", {\n    className: classes.values,\n    \"data-clearable\": clearable || void 0\n  }, selectedItems, /* @__PURE__ */React.createElement(\"input\", __spreadValues({\n    ref: useMergedRef(ref, inputRef),\n    type: \"search\",\n    id: uuid,\n    className: cx(classes.searchInput, {\n      [classes.searchInputPointer]: !searchable,\n      [classes.searchInputInputHidden]: !dropdownOpened && _value.length > 0 || !searchable && _value.length > 0,\n      [classes.searchInputEmpty]: _value.length === 0\n    }),\n    onKeyDown: handleInputKeydown,\n    value: _searchValue,\n    onChange: handleInputChange,\n    onFocus: handleInputFocus,\n    onBlur: handleInputBlur,\n    readOnly: !searchable || valuesOverflow.current || readOnly,\n    placeholder: _value.length === 0 ? placeholder : void 0,\n    disabled,\n    \"data-mantine-stop-propagation\": dropdownOpened,\n    autoComplete: \"off\",\n    onCompositionStart: () => setIMEOpen(true),\n    onCompositionEnd: () => setIMEOpen(false)\n  }, rest)))))), /* @__PURE__ */React.createElement(SelectPopover.Dropdown, {\n    component: dropdownComponent || SelectScrollArea,\n    maxHeight: maxDropdownHeight,\n    direction,\n    id: uuid,\n    innerRef: scrollableRef,\n    __staticSelector: \"MultiSelect\",\n    classNames,\n    styles\n  }, /* @__PURE__ */React.createElement(SelectItems, {\n    data: filteredData,\n    hovered,\n    classNames,\n    styles,\n    uuid,\n    __staticSelector: \"MultiSelect\",\n    onItemHover: setHovered,\n    onItemSelect: handleItemSelect,\n    itemsRefs,\n    itemComponent,\n    size,\n    nothingFound,\n    isItemSelected,\n    creatable: creatable && !!createLabel,\n    createLabel,\n    unstyled,\n    variant\n  }))));\n});\nMultiSelect.displayName = \"@mantine/core/MultiSelect\";\nexport { MultiSelect, defaultFilter, defaultShouldCreate };","map":{"version":3,"sources":["../../src/MultiSelect/MultiSelect.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useState, useRef, forwardRef } from 'react';\nimport {\n  useUncontrolled,\n  useMergedRef,\n  useDidUpdate,\n  useScrollIntoView,\n  useId,\n} from '@mantine/hooks';\nimport {\n  DefaultProps,\n  Selectors,\n  getDefaultZIndex,\n  useComponentDefaultProps,\n} from '@mantine/styles';\nimport { groupOptions } from '@mantine/utils';\nimport { extractSystemStyles } from '../Box';\nimport { Input } from '../Input';\nimport { DefaultValue, DefaultValueStylesNames } from './DefaultValue/DefaultValue';\nimport { DefaultItem } from '../Select/DefaultItem/DefaultItem';\nimport { filterData } from './filter-data/filter-data';\nimport { getSelectRightSectionProps } from '../Select/SelectRightSection/get-select-right-section-props';\nimport { SelectScrollArea } from '../Select/SelectScrollArea/SelectScrollArea';\nimport { SelectPopover } from '../Select/SelectPopover/SelectPopover';\nimport { SelectItem, BaseSelectProps, BaseSelectStylesNames } from '../Select/types';\nimport { SelectItems } from '../Select/SelectItems/SelectItems';\nimport useStyles from './MultiSelect.styles';\nimport { SelectSharedProps } from '../Select/Select';\n\nexport type MultiSelectStylesNames =\n  | DefaultValueStylesNames\n  | Exclude<\n      Selectors<typeof useStyles>,\n      'searchInputEmpty' | 'searchInputInputHidden' | 'searchInputPointer'\n    >\n  | Exclude<BaseSelectStylesNames, 'selected'>;\n\nexport interface MultiSelectProps\n  extends DefaultProps<MultiSelectStylesNames>,\n    BaseSelectProps,\n    Omit<SelectSharedProps<SelectItem, string[]>, 'filter'> {\n  /** Component used to render values */\n  valueComponent?: React.FC<any>;\n\n  /** Maximum dropdown height */\n  maxDropdownHeight?: number | string;\n\n  /** Enable items searching */\n  searchable?: boolean;\n\n  /** Function based on which items in dropdown are filtered */\n  filter?(value: string, selected: boolean, item: SelectItem): boolean;\n\n  /** Clear search value when item is selected */\n  clearSearchOnChange?: boolean;\n\n  /** Allow to clear item */\n  clearable?: boolean;\n\n  /** Disable removing selected items from the list */\n  disableSelectedItemFiltering?: boolean;\n\n  /** Clear search field value on blur */\n  clearSearchOnBlur?: boolean;\n\n  /** Called each time search query changes */\n  onSearchChange?(query: string): void;\n\n  /** Controlled search input value */\n  searchValue?: string;\n\n  /** Hovers the first result when search query changes */\n  hoverOnSearchChange?: boolean;\n\n  /** Allow creatable option  */\n  creatable?: boolean;\n\n  /** Function to get create Label */\n  getCreateLabel?(query: string): React.ReactNode;\n\n  /** Function to determine if create label should be displayed */\n  shouldCreate?(query: string, data: SelectItem[]): boolean;\n\n  /** Called when create option is selected */\n  onCreate?(query: string): SelectItem | string | null | undefined;\n\n  /** Change dropdown component, can be used to add custom scrollbars */\n  dropdownComponent?: any;\n\n  /** Limit amount of items selected */\n  maxSelectedValues?: number;\n\n  /** Select highlighted item on blur */\n  selectOnBlur?: boolean;\n\n  /** Props added to clear button */\n  clearButtonProps?: React.ComponentPropsWithoutRef<'button'>;\n}\n\nexport function defaultFilter(value: string, selected: boolean, item: SelectItem) {\n  if (selected) {\n    return false;\n  }\n  return item.label.toLowerCase().trim().includes(value.toLowerCase().trim());\n}\n\nexport function defaultShouldCreate(query: string, data: SelectItem[]) {\n  return !!query && !data.some((item) => item.value.toLowerCase() === query.toLowerCase());\n}\n\nfunction filterValue(value: string[], data: ReadonlyArray<string | SelectItem>): string[] {\n  if (!Array.isArray(value)) {\n    return undefined;\n  }\n\n  if (data.length === 0) {\n    return [];\n  }\n\n  const flatData: string[] = data.map((item) => {\n    if (typeof item === 'object') {\n      return item.value;\n    }\n    return item;\n  });\n  return value.filter((val) => flatData.includes(val));\n}\n\nconst defaultProps: Partial<MultiSelectProps> = {\n  size: 'sm',\n  valueComponent: DefaultValue,\n  itemComponent: DefaultItem,\n  transitionProps: { transition: 'fade', duration: 0 },\n  maxDropdownHeight: 220,\n  shadow: 'sm',\n  searchable: false,\n  filter: defaultFilter,\n  limit: Infinity,\n  clearSearchOnChange: true,\n  clearable: false,\n  clearSearchOnBlur: false,\n  disabled: false,\n  initiallyOpened: false,\n  creatable: false,\n  shouldCreate: defaultShouldCreate,\n  switchDirectionOnFlip: false,\n  zIndex: getDefaultZIndex('popover'),\n  selectOnBlur: false,\n  positionDependencies: [],\n  dropdownPosition: 'flip',\n};\n\nexport const MultiSelect = forwardRef<HTMLInputElement, MultiSelectProps>((props, ref) => {\n  const {\n    className,\n    style,\n    required,\n    label,\n    description,\n    size,\n    error,\n    classNames,\n    styles,\n    wrapperProps,\n    value,\n    defaultValue,\n    data,\n    onChange,\n    valueComponent: Value,\n    itemComponent,\n    id,\n    transitionProps,\n    maxDropdownHeight,\n    shadow,\n    nothingFound,\n    onFocus,\n    onBlur,\n    searchable,\n    placeholder,\n    filter,\n    limit,\n    clearSearchOnChange,\n    clearable,\n    clearSearchOnBlur,\n    variant,\n    onSearchChange,\n    searchValue,\n    disabled,\n    initiallyOpened,\n    radius,\n    icon,\n    rightSection,\n    rightSectionWidth,\n    creatable,\n    getCreateLabel,\n    shouldCreate,\n    onCreate,\n    sx,\n    dropdownComponent,\n    onDropdownClose,\n    onDropdownOpen,\n    maxSelectedValues,\n    withinPortal,\n    switchDirectionOnFlip,\n    zIndex,\n    selectOnBlur,\n    name,\n    dropdownPosition,\n    errorProps,\n    labelProps,\n    descriptionProps,\n    form,\n    positionDependencies,\n    onKeyDown,\n    unstyled,\n    inputContainer,\n    inputWrapperOrder,\n    readOnly,\n    withAsterisk,\n    clearButtonProps,\n    hoverOnSearchChange,\n    disableSelectedItemFiltering,\n    ...others\n  } = useComponentDefaultProps('MultiSelect', defaultProps, props);\n\n  const { classes, cx, theme } = useStyles(\n    { invalid: !!error },\n    { name: 'MultiSelect', classNames, styles, unstyled, size, variant }\n  );\n  const { systemStyles, rest } = extractSystemStyles(others);\n  const inputRef = useRef<HTMLInputElement>();\n  const itemsRefs = useRef<Record<string, HTMLDivElement>>({});\n  const uuid = useId(id);\n  const [dropdownOpened, setDropdownOpened] = useState(initiallyOpened);\n  const [_hovered, setHovered] = useState(-1);\n  const [direction, setDirection] = useState<React.CSSProperties['flexDirection']>('column');\n  const [_searchValue, handleSearchChange] = useUncontrolled({\n    value: searchValue,\n    defaultValue: '',\n    finalValue: undefined,\n    onChange: onSearchChange,\n  });\n  const [IMEOpen, setIMEOpen] = useState(false);\n\n  const { scrollIntoView, targetRef, scrollableRef } = useScrollIntoView({\n    duration: 0,\n    offset: 5,\n    cancelable: false,\n    isList: true,\n  });\n\n  const isCreatable = creatable && typeof getCreateLabel === 'function';\n  let createLabel = null;\n\n  const formattedData = data.map((item) =>\n    typeof item === 'string' ? { label: item, value: item } : item\n  );\n\n  const sortedData = groupOptions({ data: formattedData });\n\n  const [_value, setValue] = useUncontrolled({\n    value: filterValue(value, data),\n    defaultValue: filterValue(defaultValue, data),\n    finalValue: [],\n    onChange,\n  });\n\n  const valuesOverflow = useRef(!!maxSelectedValues && maxSelectedValues < _value.length);\n\n  const handleValueRemove = (_val: string) => {\n    if (!readOnly) {\n      const newValue = _value.filter((val) => val !== _val);\n      setValue(newValue);\n\n      if (!!maxSelectedValues && newValue.length < maxSelectedValues) {\n        valuesOverflow.current = false;\n      }\n    }\n  };\n\n  const handleInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    handleSearchChange(event.currentTarget.value);\n    !disabled && !valuesOverflow.current && searchable && setDropdownOpened(true);\n  };\n\n  const handleInputFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    typeof onFocus === 'function' && onFocus(event);\n    !disabled && !valuesOverflow.current && searchable && setDropdownOpened(true);\n  };\n\n  const filteredData = filterData({\n    data: sortedData,\n    searchable,\n    searchValue: _searchValue,\n    limit,\n    filter,\n    value: _value,\n    disableSelectedItemFiltering,\n  });\n\n  if (isCreatable && shouldCreate(_searchValue, sortedData)) {\n    createLabel = getCreateLabel(_searchValue);\n    filteredData.push({ label: _searchValue, value: _searchValue, creatable: true });\n  }\n\n  const hovered = Math.min(_hovered, filteredData.length - 1);\n\n  const getNextIndex = (\n    index: number,\n    nextItem: (index: number) => number,\n    compareFn: (index: number) => boolean\n  ) => {\n    let i = index;\n    while (compareFn(i)) {\n      i = nextItem(i);\n      if (!filteredData[i].disabled) return i;\n    }\n    return index;\n  };\n\n  useDidUpdate(() => {\n    if (hoverOnSearchChange && _searchValue) {\n      setHovered(0);\n    } else {\n      setHovered(-1);\n    }\n  }, [_searchValue, hoverOnSearchChange]);\n\n  useDidUpdate(() => {\n    if (!disabled && _value.length > data.length) {\n      setDropdownOpened(false);\n    }\n\n    if (!!maxSelectedValues && _value.length < maxSelectedValues) {\n      valuesOverflow.current = false;\n    }\n\n    if (!!maxSelectedValues && _value.length >= maxSelectedValues) {\n      valuesOverflow.current = true;\n      setDropdownOpened(false);\n    }\n  }, [_value]);\n\n  const handleItemSelect = (item: SelectItem) => {\n    if (!readOnly) {\n      clearSearchOnChange && handleSearchChange('');\n\n      if (_value.includes(item.value)) {\n        handleValueRemove(item.value);\n      } else {\n        if (item.creatable && typeof onCreate === 'function') {\n          const createdItem = onCreate(item.value);\n          if (typeof createdItem !== 'undefined' && createdItem !== null) {\n            if (typeof createdItem === 'string') {\n              setValue([..._value, createdItem]);\n            } else {\n              setValue([..._value, createdItem.value]);\n            }\n          }\n        } else {\n          setValue([..._value, item.value]);\n        }\n\n        if (_value.length === maxSelectedValues - 1) {\n          valuesOverflow.current = true;\n          setDropdownOpened(false);\n        }\n        if (filteredData.length === 1) {\n          setDropdownOpened(false);\n        }\n      }\n    }\n  };\n\n  const handleInputBlur = (event: React.FocusEvent<HTMLInputElement>) => {\n    typeof onBlur === 'function' && onBlur(event);\n    if (selectOnBlur && filteredData[hovered] && dropdownOpened) {\n      handleItemSelect(filteredData[hovered]);\n    }\n    clearSearchOnBlur && handleSearchChange('');\n    setDropdownOpened(false);\n  };\n\n  const handleInputKeydown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (IMEOpen) {\n      return;\n    }\n\n    onKeyDown?.(event);\n\n    if (readOnly) {\n      return;\n    }\n\n    if (event.key !== 'Backspace' && !!maxSelectedValues && valuesOverflow.current) {\n      return;\n    }\n\n    const isColumn = direction === 'column';\n\n    const handleNext = () => {\n      setHovered((current) => {\n        const nextIndex = getNextIndex(\n          current,\n          (index) => index + 1,\n          (index) => index < filteredData.length - 1\n        );\n\n        if (dropdownOpened) {\n          targetRef.current = itemsRefs.current[filteredData[nextIndex]?.value];\n\n          scrollIntoView({\n            alignment: isColumn ? 'end' : 'start',\n          });\n        }\n\n        return nextIndex;\n      });\n    };\n\n    const handlePrevious = () => {\n      setHovered((current) => {\n        const nextIndex = getNextIndex(\n          current,\n          (index) => index - 1,\n          (index) => index > 0\n        );\n\n        if (dropdownOpened) {\n          targetRef.current = itemsRefs.current[filteredData[nextIndex]?.value];\n\n          scrollIntoView({\n            alignment: isColumn ? 'start' : 'end',\n          });\n        }\n\n        return nextIndex;\n      });\n    };\n\n    switch (event.key) {\n      case 'ArrowUp': {\n        event.preventDefault();\n        setDropdownOpened(true);\n\n        isColumn ? handlePrevious() : handleNext();\n\n        break;\n      }\n\n      case 'ArrowDown': {\n        event.preventDefault();\n        setDropdownOpened(true);\n\n        isColumn ? handleNext() : handlePrevious();\n\n        break;\n      }\n\n      case 'Enter': {\n        event.preventDefault();\n\n        if (filteredData[hovered] && dropdownOpened) {\n          handleItemSelect(filteredData[hovered]);\n        } else {\n          setDropdownOpened(true);\n        }\n\n        break;\n      }\n\n      case ' ': {\n        if (!searchable) {\n          event.preventDefault();\n          if (filteredData[hovered] && dropdownOpened) {\n            handleItemSelect(filteredData[hovered]);\n          } else {\n            setDropdownOpened(true);\n          }\n        }\n\n        break;\n      }\n\n      case 'Backspace': {\n        if (_value.length > 0 && _searchValue.length === 0) {\n          setValue(_value.slice(0, -1));\n          setDropdownOpened(true);\n          if (maxSelectedValues) {\n            valuesOverflow.current = false;\n          }\n        }\n\n        break;\n      }\n\n      case 'Home': {\n        if (!searchable) {\n          event.preventDefault();\n\n          if (!dropdownOpened) {\n            setDropdownOpened(true);\n          }\n\n          const firstItemIndex = filteredData.findIndex((item) => !item.disabled);\n          setHovered(firstItemIndex);\n          scrollIntoView({\n            alignment: isColumn ? 'end' : 'start',\n          });\n        }\n        break;\n      }\n\n      case 'End': {\n        if (!searchable) {\n          event.preventDefault();\n\n          if (!dropdownOpened) {\n            setDropdownOpened(true);\n          }\n\n          const lastItemIndex = filteredData.map((item) => !!item.disabled).lastIndexOf(false);\n          setHovered(lastItemIndex);\n          scrollIntoView({\n            alignment: isColumn ? 'end' : 'start',\n          });\n        }\n        break;\n      }\n\n      case 'Escape': {\n        setDropdownOpened(false);\n      }\n    }\n  };\n\n  const selectedItems = _value\n    .map((val) => {\n      let selectedItem = sortedData.find((item) => item.value === val && !item.disabled);\n      if (!selectedItem && isCreatable) {\n        selectedItem = {\n          value: val,\n          label: val,\n        };\n      }\n      return selectedItem;\n    })\n    .filter((val) => !!val)\n    .map((item, index) => (\n      <Value\n        {...item}\n        variant={variant}\n        disabled={disabled}\n        className={classes.value}\n        readOnly={readOnly}\n        onRemove={(event: React.MouseEvent<HTMLButtonElement>) => {\n          event.preventDefault();\n          event.stopPropagation();\n          handleValueRemove(item.value);\n        }}\n        key={item.value}\n        size={size}\n        styles={styles}\n        classNames={classNames}\n        radius={radius}\n        index={index}\n      />\n    ));\n\n  const isItemSelected = (itemValue: string) => _value.includes(itemValue);\n\n  const handleClear = () => {\n    handleSearchChange('');\n    setValue([]);\n    inputRef.current?.focus();\n    if (maxSelectedValues) {\n      valuesOverflow.current = false;\n    }\n  };\n\n  const shouldRenderDropdown =\n    !readOnly && (filteredData.length > 0 ? dropdownOpened : dropdownOpened && !!nothingFound);\n\n  useDidUpdate(() => {\n    const handler = shouldRenderDropdown ? onDropdownOpen : onDropdownClose;\n    typeof handler === 'function' && handler();\n  }, [shouldRenderDropdown]);\n\n  return (\n    <Input.Wrapper\n      required={required}\n      id={uuid}\n      label={label}\n      error={error}\n      description={description}\n      size={size}\n      className={className}\n      style={style}\n      classNames={classNames}\n      styles={styles}\n      __staticSelector=\"MultiSelect\"\n      sx={sx}\n      errorProps={errorProps}\n      descriptionProps={descriptionProps}\n      labelProps={labelProps}\n      inputContainer={inputContainer}\n      inputWrapperOrder={inputWrapperOrder}\n      unstyled={unstyled}\n      withAsterisk={withAsterisk}\n      variant={variant}\n      {...systemStyles}\n      {...wrapperProps}\n    >\n      <SelectPopover\n        opened={shouldRenderDropdown}\n        transitionProps={transitionProps}\n        shadow=\"sm\"\n        withinPortal={withinPortal}\n        __staticSelector=\"MultiSelect\"\n        onDirectionChange={setDirection}\n        switchDirectionOnFlip={switchDirectionOnFlip}\n        zIndex={zIndex}\n        dropdownPosition={dropdownPosition}\n        positionDependencies={[...positionDependencies, _searchValue]}\n        classNames={classNames}\n        styles={styles}\n        unstyled={unstyled}\n        variant={variant}\n      >\n        <SelectPopover.Target>\n          <div\n            className={classes.wrapper}\n            role=\"combobox\"\n            aria-haspopup=\"listbox\"\n            aria-owns={dropdownOpened && shouldRenderDropdown ? `${uuid}-items` : null}\n            aria-controls={uuid}\n            aria-expanded={dropdownOpened}\n            onMouseLeave={() => setHovered(-1)}\n            tabIndex={-1}\n          >\n            <input\n              type=\"hidden\"\n              name={name}\n              value={_value.join(',')}\n              form={form}\n              disabled={disabled}\n            />\n\n            <Input<'div'>\n              __staticSelector=\"MultiSelect\"\n              style={{ overflow: 'hidden' }}\n              component=\"div\"\n              multiline\n              size={size}\n              variant={variant}\n              disabled={disabled}\n              error={error}\n              required={required}\n              radius={radius}\n              icon={icon}\n              unstyled={unstyled}\n              onMouseDown={(event) => {\n                event.preventDefault();\n                !disabled && !valuesOverflow.current && setDropdownOpened(!dropdownOpened);\n                inputRef.current?.focus();\n              }}\n              classNames={{\n                ...classNames,\n                input: cx({ [classes.input]: !searchable }, classNames?.input),\n              }}\n              {...getSelectRightSectionProps({\n                theme,\n                rightSection,\n                rightSectionWidth,\n                styles,\n                size,\n                shouldClear: clearable && _value.length > 0,\n                onClear: handleClear,\n                error,\n                disabled,\n                clearButtonProps,\n                readOnly,\n              })}\n            >\n              <div className={classes.values} data-clearable={clearable || undefined}>\n                {selectedItems}\n\n                <input\n                  ref={useMergedRef(ref, inputRef)}\n                  type=\"search\"\n                  id={uuid}\n                  className={cx(classes.searchInput, {\n                    [classes.searchInputPointer]: !searchable,\n                    [classes.searchInputInputHidden]:\n                      (!dropdownOpened && _value.length > 0) || (!searchable && _value.length > 0),\n                    [classes.searchInputEmpty]: _value.length === 0,\n                  })}\n                  onKeyDown={handleInputKeydown}\n                  value={_searchValue}\n                  onChange={handleInputChange}\n                  onFocus={handleInputFocus}\n                  onBlur={handleInputBlur}\n                  readOnly={!searchable || valuesOverflow.current || readOnly}\n                  placeholder={_value.length === 0 ? placeholder : undefined}\n                  disabled={disabled}\n                  data-mantine-stop-propagation={dropdownOpened}\n                  autoComplete=\"off\"\n                  onCompositionStart={() => setIMEOpen(true)}\n                  onCompositionEnd={() => setIMEOpen(false)}\n                  {...rest}\n                />\n              </div>\n            </Input>\n          </div>\n        </SelectPopover.Target>\n\n        <SelectPopover.Dropdown\n          component={dropdownComponent || SelectScrollArea}\n          maxHeight={maxDropdownHeight}\n          direction={direction}\n          id={uuid}\n          innerRef={scrollableRef}\n          __staticSelector=\"MultiSelect\"\n          classNames={classNames}\n          styles={styles}\n        >\n          <SelectItems\n            data={filteredData}\n            hovered={hovered}\n            classNames={classNames}\n            styles={styles}\n            uuid={uuid}\n            __staticSelector=\"MultiSelect\"\n            onItemHover={setHovered}\n            onItemSelect={handleItemSelect}\n            itemsRefs={itemsRefs}\n            itemComponent={itemComponent}\n            size={size}\n            nothingFound={nothingFound}\n            isItemSelected={isItemSelected}\n            creatable={creatable && !!createLabel}\n            createLabel={createLabel}\n            unstyled={unstyled}\n            variant={variant}\n          />\n        </SelectPopover.Dropdown>\n      </SelectPopover>\n    </Input.Wrapper>\n  );\n});\n\nMultiSelect.displayName = '@mantine/core/MultiSelect';\n"]},"metadata":{},"sourceType":"module"}